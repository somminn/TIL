## 섹션9. 중첩 클래스, 내부 클래스2

### 1. 지역 클래스 - 시작
`지역 변수와 같이 코드블럭 안에 클래스를 선언함!`
- 지역 클래스는 메서드 안에서만 유효하며, 메서드가 실행될 때 정의됨
- **자기 내부에서 자기 자신을 생성할 수 없음 → 클래스가 아직 존재하지 않기 때문**
- 메서드 내부에서는 인스턴스를 생성 가능 → 이때는 클래스가 이미 정의된 상태이므로 가능

#### 지역 클래스의 접근 범위
- 자신의 인스턴스 변수
- 자신이 속한 코드블럭 안의 지역 변수
- 자신이 속한 코드블럭의 매개 변수
- 바깥 클래스의 인스턴스 멤버 변수

### 2. 지역 클래스 - 지역 변수 캡처1
`변수의 생명주기 : 클래스 변수 > 인스턴스 변수 > 지역변수`

#### 인스턴스 변수와 지역 변수

|    구분     |            인스턴스 변수             |            지역 변수            |
|:---------:|:------------------------------:|:---------------------------:|
|   선언 위치   |         클래스 내부, 메서드 내부         |        메서드 또는 블록 내부         |
| 메모리 <br/>할당 위치 |            힙 영역에 저장            |          스택 영역에 저장          |
|   생존 범위   | 객체가 생성될 때 할당되고,<br/> 소멸될 때 해제됨 | 변수가 선언된 블록(메서드)<br/>내에서만 유효 |


### 3. 지역 클래스 - 지역 변수 캡처2
######  지역 클래스를 통해 생성된 인스턴스가 지역 변수에 접근해야 하는데, 둘의 생명주기가 다르기 때문에 인스턴스는 살아있지만, 지역변수는 이미 제거되었을 경우에는?
`지역 클래스는 인스턴스를 생성할 때 필요한 지역 변수를 먼저 캡처해서 인스턴스에 보관한다!`

#### 지역 클래스의 인스턴스 생성과 지역 변수 캡처 과정
![캡처과정](https://github.com/somminn/TIL/blob/main/image/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-03-12%20%EC%98%A4%EC%A0%84%2012.15.38.png?raw=true)
1. 지역 클래스 인스턴스 생성
2. 사용하는 지역 변수 복사(스택 영역)
3. 복사한 지역 변수를 인스턴스에 포함시킴(힙 영역) : 지역 클래스의 인스턴스를 통해 지역 변수에 접근하면, 실제로는 지역변수에 접근하는 것이 아니라 인스턴스에 있는 캡처한 캡처 변수에 접근하는 것
4. 인스턴스 생성 완료


### 4. 지역 클래스 - 지역 변수 캡처3
`지역 클래스가 접근하는 지역 변수의 값은 변경하면 안된다!`  
`final 이거나 사실상 final`

#### 캡처 변수의 값을 변경하지 못하는 이유
- 지역 변수의 값을 변경하면 인스턴스에 캡처한 변수의 값도 변경해야 함
- 반대로 인스턴스에 있는 캡처 변수의 값을 변경하면 해당 지역 변수의 값도 다시 변경해야 함
- 디버깅이 어려워짐



### 5. 익명 클래스 - 시작  
`익명 클래스는 지역 클래스인데, 클래스의 이름이 없는 것!`

- 기존 코드
```
class LocalPrinter implements Printer {}
LocalPrinter printer = new LocalPrinter();
```

- 익명 코드
```
 Printer printer = new Printer() {
```

#### 익명 클래스의 특징
- 익명 클래스는 이름 없는 지역 클래스를 선언하면서 동시에 생성하는 것
- 특정 부모 클래스(인터페이스)를 상속 받고 바로 생성하는 경우에 사용
- 이름을 가지지 않으므로, 생성자를 가질 수 없음
- 인터페이스를 생성하는 것이 아니고 인터페이스를 구현한 익명 클래스를 생성하는 것!
- 일회성으로 사용되는 경우나 간단한 구현을 제공할 때 사용

### 6. 익명 클래스 활용1
`변하는 부분을 메서드(함수) 외부에서 전달 받으면 재사용성이 높아진다!`

### 7. 익명 클래스 활용2
메서드(함수)만을 전달하는 것을 불가능하다.  
`따라서 코드 조각을 메서드에 전달 할때는 인스턴스를 전달하고 해당 인스턴스에 있는 메서드를 호출하면 된다!`

### 8. 익명 클래스 활용3
자바8 이전까지 메서드에 인수로 전달할 수 있는 것은 기본형 타입(int, double 등)과 참조형 타입(인스턴스) 뿐이었다. 
자바 8의 람다 기능으로 메서드(함수)도 전달할수있게 되었다.









#### 배열 나누어서 생성하기 
```
private Book[] books;

public Library(int size) {
        books = new Book[size];
}
```

#### 빈 배열에 순서대로 넣기
```
books[bookCount++] = new Book(title,author);
```


#### 배열에 빈 값 있을 때
배열이 빈 값이 있을때는 iter을 이용해서 루프를 돌리면 NullPointerException이 터진다.



















    